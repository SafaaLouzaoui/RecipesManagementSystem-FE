<div class="myContainer">
  <header class="headTitle">
    <h1
      style="
        text-align: center;
        color: white;
        margin-top: 0px;
        padding-top: 5px;
        font-family: Georgia, 'Times New Roman', Times, serif;
      "
    >
      Create New Recipe
    </h1>
  </header>
  <form (ngSubmit)="createRecette()">
    <div class="form-group">
      <label for="nom">Recipe Name:</label>
      <input type="text" id="nom" name="nom" [(ngModel)]="nom" />
    </div>

    <div class="form-group">
      <label for="description">Description:</label>
      <textarea
        id="description"
        name="description"
        [(ngModel)]="description"
      ></textarea>
    </div>

    <div class="form-group">
      <label for="origine">Origin:</label>
      <input type="text" id="origine" name="origine" [(ngModel)]="origine" />
    </div>

    <div class="form-group">
      <label for="dureePreparation">Preparation Time (minutes):</label>
      <input
        type="number"
        id="dureePreparation"
        name="dureePreparation"
        [(ngModel)]="dureePreparation"
      />
    </div>

    <div class="form-group">
      <label for="dureeCuisson">Cooking Time (minutes):</label>
      <input
        type="number"
        id="dureeCuisson"
        name="dureeCuisson"
        [(ngModel)]="dureeCuisson"
      />
    </div>


    <div class="form-group">
      <label for="nbrPersonnes">Number of Servings:</label>
      <input
        type="number"
        id="nbrPersonnes"
        name="nbrPersonnes"
        [(ngModel)]="nbrPersonnes"
      />
    </div>

    <!-- Dynamically add ingredients -->
    <div class="form-group">
      <h5>Ingredients:</h5>
      <div *ngFor="let ingredient of ingredients; let i = index">
        <p>the ingredient {{ i + 1 }}</p>
        <select
          [(ngModel)]="ingredients[i]"
          name="ingredients{{ i }}"
          class="form-select"
          aria-label="Default select example"
          [ngModelOptions]="{ standalone: true }"
        >
          <option *ngFor="let ing of ingrediantss" [ngValue]="ing">
            {{ ing.nom }}
          </option>
        </select>
        <div class="two-col">
          <input
            type="number"
            [(ngModel)]="quantites[i].nombre"
            [ngModelOptions]="{ standalone: true }"
            placeholder="nombre de quantite"
          />
          <input
            type="text"
            [(ngModel)]="quantites[i].uniteDeMesure"
            [ngModelOptions]="{ standalone: true }"
            placeholder="unite de mesure"
          />
        </div>

        <button
          type="button"
          class="myButton removeButt"
          (click)="removeIngredient(i)"
        >
          Remove
        </button>
      </div>
      <button
        type="button"
        class="myButton addButt"
        (click)="addIngredient()"
        (click)="onAddButtonClick()"
      >
        Add Ingredient
      </button>
    </div>

    <!-- Dynamically add steps (etapes) -->
    <div class="form-group">
      <h5>Steps:</h5>
      <div *ngFor="let etape of etapes; let i = index">
        <p>The step: {{ i + 1 }}</p>
        <div class="two-col">
          <input
            type="number"
            [(ngModel)]="etape.ordre"
            [ngModelOptions]="{ standalone: true }"
            placeholder="ordre"
          />
          <input
            type="number"
            [(ngModel)]="etape.duree"
            [ngModelOptions]="{ standalone: true }"
            placeholder="duree"
          />
        </div>
        <textarea
          [(ngModel)]="etape.description"
          [ngModelOptions]="{ standalone: true }"
          placeholder="description de l'etape"
        ></textarea>
        <div class="media-container">
          <input
          type="file"
          id="inputList"
          (change)="onMediaFileSelectedEtape($event, i)"
          accept="image/jpeg, image/png, image/gif"
        />
        <img *ngIf="etape.media" [src]="etape.media" alt="Image" class="image-preview">
        </div>
        <span style="color: red;">{{ errorEtape[i] }}</span>
        <button
          type="button"
          class="myButton removeButt"
          (click)="removeEtape(i)"
        >
          Remove
        </button>
      </div>
      <button
        type="button"
        class="myButton addButt"
        (click)="addEtape()"
        (click)="onAddButtonClick()"
      >
        Add Step
      </button>
    </div>

    <!-- Dynamically add besoins (besoins) -->
    <div class="form-group">
      <h5>Besoins:</h5>
      <div *ngFor="let besoin of besoins; let i = index">
        <p>besoin : {{ i + 1 }}</p>
        <div class="two-col">
          <input
            type="text"
            [(ngModel)]="besoin.nom"
            [ngModelOptions]="{ standalone: true }"
            placeholder="nom"
          />
          <input
            type="text"
            [(ngModel)]="besoin.type"
            [ngModelOptions]="{ standalone: true }"
            placeholder="type"
          />
        </div>
        <textarea
          [(ngModel)]="besoin.description"
          [ngModelOptions]="{ standalone: true }"
          placeholder="Methode d'utilisation"
        ></textarea>
        Add your media upload input here (e.g., file input, image uploader)
        <button
          type="button"
          class="myButton removeButt"
          (click)="removeBesoin(i)"
        >
          Remove
        </button>
      </div>
      <button
        type="button"
        class="myButton addButt"
        (click)="addBesoin()"
        (click)="onAddButtonClick()"
      >
        Add Step
      </button>
    </div>

    <!-- Dynamically add categories -->
    <div class="form-group">
      <h5>Categories:</h5>
      <div *ngFor="let cat of categories; let i = index">
        <p>the ingredient {{ i + 1 }}</p>
        <select
          [(ngModel)]="categories[i]"
          class="form-select"
          aria-label="Default select example"
          [ngModelOptions]="{ standalone: true }"
        >
          <option *ngFor="let categorie of categoriess" [ngValue]="categorie">
            {{ categorie.nomCat }}
          </option>
        </select>
        <button
          type="button"
          class="myButton removeButt"
          (click)="removeCategorie(i)"
        >
          Remove
        </button>
      </div>
      <button
        type="button"
        class="myButton addButt"
        (click)="addCategorie()"
        (click)="onAddButtonClick()"
      >
        Add Ingredient
      </button>
    </div>

    <!-- Media upload -->
  <div class="form-group">
    <h5>Media:</h5>
    <div class="input-container">
      <div *ngFor="let media of medias; let i = index" >
        <div class="media-container">
          <input
          type="file"
          id="inputList"
          (change)="onMediaFileSelected($event, i)"
          accept="image/jpeg, image/png, image/gif"
        />
        <img *ngIf="media.url" [src]="media.url" alt="Image" class="image-preview">
        </div>
        <span style="color: red;">{{ errorMedia[i] }}</span>
        <button
          type="button"
          class="myButton removeButt"
          (click)="removeMedia(i)"
        >
          Remove
        </button>
      </div>
    </div>
    <button
      type="button"
      class="myButton addButt"
      (click)="addMedia()"
    >
      Add Media
    </button>
  </div>

    <div class="form-group">
      <h5>Mot cles</h5>
      <div class="input-container">
        <div *ngFor="let mot of motCles; let i = index">
          <input
            type="text"
            id="inputList"
            list="options"
            [(ngModel)]="motCles[i].mot"
            [ngModelOptions]="{ standalone: true }"
          />
          <datalist id="options">
            <option *ngFor="let motCle of motCless" [ngValue]="motCle.mot">
              {{ motCle.mot }}
            </option>
          </datalist>
          <button
            type="button"
            class="myButton removeButt"
            (click)="removeMotCle(i)"
          >
            Remove
          </button>
        </div>
      </div>
      <button
        type="button"
        class="myButton addButt"
        (click)="addMotCle()"
        (click)="onAddButtonClick()"
      >
        Add Mot cle
      </button>
    </div>

    <br />
    <hr />
    <br />
    <div class="form-group bossDiv">
      <button type="submit" class="btn bossBtn">Create Recipe</button>
      <button type="button" class="btn bossBtn" (click)="cancel()">
        Cancel
      </button>
    </div>
  </form>
</div>
